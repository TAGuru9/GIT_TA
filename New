DECLARE @Year  INT = 2025;      -- year to report
DECLARE @Month INT = NULL;      -- optional month filter
DECLARE @Owner NVARCHAR(200) = NULL;  -- specific person or NULL

SELECT
    YEAR(T.TS_CREATION_DATE)  AS Run_Year,
    MONTH(T.TS_CREATION_DATE) AS Run_Month,
    T.TS_RESPONSIBLE          AS Resource,  -- designer/owner in ALM
    -- Created (TA only)
    COUNT(*) AS Created_TA_Total,
    -- Modified (TA only, modified in the selected year)
    SUM(CASE WHEN YEAR(T.TS_VTS) = @Year THEN 1 ELSE 0 END) AS Modified_TA_Total
FROM [amfc_isqat_db].[td].[TEST] AS T
WHERE T.TS_NAME LIKE 'TA\_%' ESCAPE '\'
  AND YEAR(T.TS_CREATION_DATE) = @Year
  AND (@Month IS NULL OR MONTH(T.TS_CREATION_DATE) = @Month)
  AND (@Owner IS NULL OR T.TS_RESPONSIBLE = @Owner)
GROUP BY
    YEAR(T.TS_CREATION_DATE),
    MONTH(T.TS_CREATION_DATE),
    T.TS_RESPONSIBLE
ORDER BY Run_Year, Run_Month, Resource;

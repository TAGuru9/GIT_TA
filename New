DECLARE @Year  INT = 2025;  -- Example: 2025
DECLARE @Month INT = NULL;  -- Example: 6, or NULL for all months

SELECT
    YEAR(T.TS_CREATION_DATE)  AS Run_Year,
    MONTH(T.TS_CREATION_DATE) AS Run_Month,
    SUM(CASE WHEN T.TS_NAME LIKE 'TA\_%' ESCAPE '\' THEN 1 ELSE 0 END) AS Created_Automated,
    SUM(CASE WHEN T.TS_NAME NOT LIKE 'TA\_%' ESCAPE '\' THEN 1 ELSE 0 END) AS Created_Manual,
    COUNT(*) AS Created_Total
FROM [amfc_isqat_db].[td].[TEST] AS T
WHERE YEAR(T.TS_CREATION_DATE) = @Year
  AND (@Month IS NULL OR MONTH(T.TS_CREATION_DATE) = @Month)
GROUP BY YEAR(T.TS_CREATION_DATE), MONTH(T.TS_CREATION_DATE)
ORDER BY Run_Year, Run_Month;

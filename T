# path to your html report
$reportPath = "C:\Logs\smokefinancemodule.html"

# read html
$html = Get-Content $reportPath -Raw

# parse html
$parsed = Invoke-WebRequest -Body $html -UseBasicParsing

# get all table rows
$rows = $parsed.ParsedHtml.getElementsByTagName("tr")

$tests = @()

foreach ($row in $rows) {
    $cells = $row.getElementsByTagName("td")
    if ($cells.Count -ge 2) {
        # assume col 0 = test name, col 1 = status
        $name   = ($cells.Item(0).innerText).Trim()
        $status = ($cells.Item(1).innerText).Trim()
        if ($name -and $status) {
            $tests += [pscustomobject]@{
                Name   = $name
                Status = $status
            }
        }
    }
}

# now count
$passCount = ($tests | Where-Object { $_.Status -match '^pass$|^passed$' }).Count
$failCount = ($tests | Where-Object { $_.Status -match '^fail$|^failed$' }).Count

Write-Host "Pass: $passCount"
Write-Host "Fail: $failCount"
